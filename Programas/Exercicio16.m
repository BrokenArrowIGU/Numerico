clear;
clc;
%-------------------------------------------------------
tic;
%-------------------------------------------------------
P2 = 1.5;
P3 = -1;
%-------------------------------------------------------
Q3 = -0.3;
%-------------------------------------------------------
V1 = 1;
V2 = 1;
%-------------------------------------------------------
t1 = 0;
c = 3;
l = 3;
%-------------------------------------------------------
Ea = 10^-4;
%-------------------------------------------------------
for i=1:l
    for j=1:c
        if i == j
            G(i,j) = 2;
            B(i,j) = -19;
        else
            G(i,j) = -0.99;
            B(i,j) = 9.99;
        end
    end
end
%-------------------------------------------------------
f1=@(x) P2 - V2*(V2*G(2,2) + V1*(G(2,1)*cos(x(2) - t1) + B(2,1)*sin(x(2) - t1)) + x(1)*(G(2,3)*cos(x(2) - x(3))+B(2,3)*sin(x(2)-x(3))));

f2=@(x) P3 - x(1)*(x(1)*G(3,3) + V1*(G(3,1)*cos(x(3) - t1)+B(3,1)*sin(x(3) - t1)) + V2*(G(3,2)*cos(x(3) - x(2)) + B(3,2)*sin(x(3) - x(2))));

f3=@(x) Q3- x(1)* (-x(1)*B(3,3) +V1*(G(3,1)*sin(x(3)-t1)-B(3,1)*cos(x(3)- t1))+V2*(G(3,2)*sin(x(3)-x(2))-B(3,2)*cos(x(3)-x(2))));
%-------------------------------------------------------
df1x= @(x) - V2*(G(2,3)*cos(x(2) - x(3)) + B(2,3)*sin(x(2) - x(3)));
df1y= @(x) - V2*(V1*(-G(2,1)*sin(x(2) - t1) + B(2,1)*cos(x(2) - t1)) + x(1)*(-G(2,3)*sin(x(2) - x(3)) + B(2,3)*cos(x(2) - x(3))));
df1z= @(x) - V2*(x(1)*(G(2,3)*sin(x(2) - x(3)) - B(2,3)*cos(x(2) - x(3))));
%-------------------------------------------------------
df2x= @(x) - 2*x(1)*G(3,3) - (V1*(G(3,1)*cos(x(3) - t1)+B(3,1)*sin(x(3) - t1)) + V2*(G(3,2)*cos(x(3) - x(2)) + B(3,2)*sin(x(3) - x(2))));
df2y= @(x) - x(1)*(V2*(G(3,2)*sin(x(3)-x(2)) - B(3,2)*cos(x(3) - x(2))));
df2z= @(x) - x(1)*(V1*(-G(3,1)*sin(x(3)-t1) + B(3,1)*cos(x(3)-t1)) + V2*(-G(3,2)*sin(x(3) - x(2)) + B(3,2)*cos(x(3) - x(2))));
%-------------------------------------------------------
df3x= @(x) 2*x(1)* B(3,3) - (V1*(G(3,1)*sin(x(3) - t1) - B(3,1)*cos(x(3) - t1)) + V2*(G(3,2)*sin(x(3) - x(2)) - B(3,2)*cos(x(3) - x(2))));
df3y= @(x) - x(1)*(V2*(-G(3,2)*cos(x(3) - x(2)) - B(3,2)*sin(x(3) - x(2))));
df3z= @(x) - x(1)*(V1*(G(3,1)*cos(x(3) - t1) + B(3,1)*sin(x(3) - t1)) + V2*(G(3,2)*cos(x(3) - x(2)) + B(3,2)*sin(x(3) - x(2))));
%-------------------------------------------------------
J=@(x)[df1x(x) df1y(x) df1z(x); df2x(x) df2y(x) df2z(x); df3x(x) df3y(x) df3z(x)];
f=@(x)[f1(x);f2(x);f3(x)];
x=[1;0;0];
%-------------------------------------------------------

tic;
[x1,~,t1] = Newton_Raphsons(J,f,Ea,x,false)
toc
%-------------------------------------------------------
tic;
[x2,~,t2] = Newton_Raphsons(J,f,Ea,x,true)
toc
%-------------------------------------------------------
